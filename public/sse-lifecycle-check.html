<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>SSEç›‘å¬å™¨ç”Ÿå‘½å‘¨æœŸä¿®å¤éªŒè¯</title>
</head>
<body>
  <h1>ğŸ”— SSEç›‘å¬å™¨ç”Ÿå‘½å‘¨æœŸä¿®å¤éªŒè¯</h1>
  <p>éªŒè¯Chat.vueä¸­çš„ensureSSEListeners()å‡½æ•°ä¿®å¤æ•ˆæœ</p>
  
  <button onclick="checkSSE()">æ£€æŸ¥SSEçŠ¶æ€</button>
  <button onclick="verifyListeners()">éªŒè¯ç›‘å¬å™¨</button>
  
  <div id="log"></div>
  
  <script>
    function log(msg) {
      document.getElementById("log").innerHTML += "<br>" + new Date().toLocaleTimeString() + " " + msg;
    }
    
    function checkSSE() {
      if (window.minimalSSE) {
        const status = window.minimalSSE.getStatus?.() || {};
        log("SSEè¿æ¥: " + (status.connected ? "å·²è¿æ¥" : "æœªè¿æ¥"));
      } else {
        log("MinimalSSEæœåŠ¡æœªæ‰¾åˆ°");
      }
    }
    
    function verifyListeners() {
      if (window.minimalSSE?.listeners) {
        const listeners = window.minimalSSE.listeners.get("message") || [];
        log("æ¶ˆæ¯ç›‘å¬å™¨æ•°é‡: " + listeners.length);
        if (listeners.length === 0) {
          log("è­¦å‘Š: æ²¡æœ‰æ‰¾åˆ°æ¶ˆæ¯ç›‘å¬å™¨!");
        }
      } else {
        log("æ— æ³•è®¿é—®ç›‘å¬å™¨");
      }
    }
    
    log("SSEç›‘å¬å™¨éªŒè¯å·¥å…·å·²åŠ è½½");
  </script>
</body>
</html>
