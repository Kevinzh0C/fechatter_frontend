<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä»£ç å®¡æŸ¥æµ…è‰²è°ƒä¸»é¢˜éªŒè¯</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, #f6f8fa 0%, #e6f2ff 100%);
      color: #24292f;
      line-height: 1.6;
      padding: 2rem;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 2rem;
      padding: 2rem;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(9, 105, 218, 0.1);
      border: 1px solid #e1e8ed;
    }

    .header h1 {
      color: #0969da;
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .status-section {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      box-shadow: 0 2px 8px rgba(9, 105, 218, 0.1);
      border: 1px solid #e1e8ed;
    }

    .status-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    .status-card {
      padding: 1rem;
      background: #f8f9fa;
      border-radius: 8px;
      border: 1px solid #e1e8ed;
    }

    .status-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid #f1f3f4;
    }

    .status-item:last-child {
      border-bottom: none;
    }

    .status-success {
      color: #1a7f37;
      background: #dcfce7;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.8rem;
    }

    .test-area {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      box-shadow: 0 2px 8px rgba(9, 105, 218, 0.1);
      border: 1px solid #e1e8ed;
    }

    .test-controls {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    button {
      padding: 0.5rem 1rem;
      border: 1px solid #d1d9e0;
      border-radius: 6px;
      background: #0969da;
      color: white;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    button:hover {
      background: #0860ca;
    }

    .error-message {
      color: #d1242f;
      background: rgba(209, 36, 47, 0.1);
      padding: 1rem;
      border-radius: 6px;
      border: 1px solid rgba(209, 36, 47, 0.3);
      margin: 1rem 0;
    }

    .success-message {
      color: #1a7f37;
      background: #dcfce7;
      padding: 1rem;
      border-radius: 6px;
      border: 1px solid #16a34a;
      margin: 1rem 0;
    }

    .test-output {
      border: 1px solid #e1e8ed;
      border-radius: 8px;
      background: #f8f9fa;
      min-height: 200px;
      padding: 1rem;
      overflow-y: auto;
    }

    /* æ¨¡æ‹Ÿæµ…è‰²è°ƒä»£ç é«˜äº®æ ·å¼ */
    .code-block-wrapper {
      margin: 0.75rem 0;
      border-radius: 8px;
      overflow: hidden;
      background-color: #f8f9fa;
      border: 1px solid #e1e8ed;
      box-shadow: 0 1px 3px rgba(9, 105, 218, 0.05);
    }

    .code-block-header {
      background: linear-gradient(135deg, #f1f3f4 0%, #e1e8ed 100%);
      padding: 0.5rem 1rem;
      border-bottom: 1px solid #e1e8ed;
      font-size: 0.75rem;
      color: #656d76;
      font-family: 'Consolas', 'Monaco', monospace;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .code-language {
      font-weight: 600;
      color: #0969da;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .copy-button {
      background: none;
      border: 1px solid #d1d9e0;
      color: #656d76;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.7rem;
      transition: all 0.2s ease;
    }

    .copy-button:hover {
      background-color: #f1f3f4;
      border-color: #bfbfbf;
      color: #24292f;
    }

    .hljs {
      font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', 'Monaco', monospace;
      font-size: 0.875rem;
      line-height: 1.5;
      padding: 1rem;
      background-color: #f8f9fa !important;
      color: #24292f !important;
      overflow-x: auto;
      margin: 0;
      border: none;
    }

    .inline-code {
      background-color: #f1f3f4;
      color: #24292f;
      padding: 0.125rem 0.375rem;
      border-radius: 4px;
      font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', 'Monaco', monospace;
      font-size: 0.875em;
      border: 1px solid #e1e8ed;
      white-space: nowrap;
    }

    .log-entry {
      padding: 0.5rem 0;
      border-bottom: 1px solid #f1f3f4;
      font-family: monospace;
      font-size: 0.875rem;
    }

    .log-entry:last-child {
      border-bottom: none;
    }

    .log-timestamp {
      color: #656d76;
      margin-right: 1rem;
    }

    .log-level {
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-right: 1rem;
    }

    .log-level.info {
      background: #e1f5fe;
      color: #0969da;
    }

    .log-level.success {
      background: #dcfce7;
      color: #1a7f37;
    }

    .log-level.error {
      background: rgba(209, 36, 47, 0.1);
      color: #d1242f;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- æ ‡é¢˜ -->
    <div class="header">
      <h1>ğŸ” ä»£ç å®¡æŸ¥æµ…è‰²è°ƒä¸»é¢˜éªŒè¯</h1>
      <p>éªŒè¯highlightMarkdownCodeå‡½æ•°å’Œæµ…è‰²è°ƒä¸»é¢˜åœ¨ä»£ç å®¡æŸ¥åŠŸèƒ½ä¸­çš„æ­£ç¡®åº”ç”¨</p>
    </div>

    <!-- çŠ¶æ€æ£€æŸ¥ -->
    <div class="status-section">
      <h3 style="margin-bottom: 1rem; color: #0969da;">ğŸ“Š ä¿®å¤çŠ¶æ€æ£€æŸ¥</h3>
      <div class="status-grid">
        <div class="status-card">
          <h4 style="color: #0969da; margin-bottom: 0.5rem;">å‡½æ•°å¯¼å‡º</h4>
          <div class="status-item">
            <span>highlightMarkdownCode</span>
            <span class="status-success" id="functionStatus">æ£€æŸ¥ä¸­...</span>
          </div>
        </div>
        <div class="status-card">
          <h4 style="color: #0969da; margin-bottom: 0.5rem;">ä¸»é¢˜é…ç½®</h4>
          <div class="status-item">
            <span>DiscordMessageItem</span>
            <span class="status-success" id="discordTheme">æµ…è‰²è°ƒ</span>
          </div>
          <div class="status-item">
            <span>MessageInput</span>
            <span class="status-success" id="inputTheme">æµ…è‰²è°ƒ</span>
          </div>
        </div>
        <div class="status-card">
          <h4 style="color: #0969da; margin-bottom: 0.5rem;">CSSæ ·å¼</h4>
          <div class="status-item">
            <span>æµ…è‰²è°ƒæ ·å¼</span>
            <span class="status-success" id="cssStatus">å·²åº”ç”¨</span>
          </div>
        </div>
      </div>
    </div>

    <!-- æµ‹è¯•åŒºåŸŸ -->
    <div class="test-area">
      <h3 style="margin-bottom: 1rem; color: #0969da;">ğŸ§ª åŠŸèƒ½æµ‹è¯•</h3>
      <div class="test-controls">
        <button onclick="testHighlightMarkdownCode()">æµ‹è¯• highlightMarkdownCode</button>
        <button onclick="testCodeReview()">æ¨¡æ‹Ÿä»£ç å®¡æŸ¥</button>
        <button onclick="testInlineCode()">æµ‹è¯•å†…è”ä»£ç </button>
        <button onclick="clearTestResults()">æ¸…ç©ºç»“æœ</button>
      </div>

      <div id="testOutput" class="test-output">
        <div class="log-entry">
          <span class="log-timestamp">[ç­‰å¾…æµ‹è¯•]</span>
          <span class="log-level info">INFO</span>
          <span>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•...</span>
        </div>
      </div>
    </div>

    <!-- ç¤ºä¾‹å±•ç¤º -->
    <div class="test-area">
      <h3 style="margin-bottom: 1rem; color: #0969da;">ğŸ¨ æµ…è‰²è°ƒä¸»é¢˜æ•ˆæœé¢„è§ˆ</h3>

      <h4 style="margin: 1rem 0 0.5rem 0; color: #656d76;">JavaScript ä»£ç å—ç¤ºä¾‹ï¼š</h4>
      <div class="code-block-wrapper">
        <div class="code-block-header">
          <span class="code-language">JAVASCRIPT</span>
          <button class="copy-button">Copy</button>
        </div>
        <pre class="hljs"><code>// Code review example with light theme
function reviewCode(changes) {
  const issues = [];
  
  changes.forEach(change => {
    if (change.type === 'addition') {
      console.log(`+ ${change.line}`);
    } else if (change.type === 'deletion') {
      console.log(`- ${change.line}`);
    }
  });
  
  return issues.length === 0;
}</code></pre>
      </div>

      <h4 style="margin: 1rem 0 0.5rem 0; color: #656d76;">å†…è”ä»£ç ç¤ºä¾‹ï¼š</h4>
      <p>å½“è°ƒç”¨ <code class="inline-code">highlightMarkdownCode()</code> å‡½æ•°æ—¶ï¼Œç°åœ¨ä½¿ç”¨ <code
          class="inline-code">theme: 'light'</code> å‚æ•°æ¥åº”ç”¨æµ…è‰²è°ƒä¸»é¢˜ã€‚</p>

      <h4 style="margin: 1rem 0 0.5rem 0; color: #656d76;">é”™è¯¯ä¿®å¤å‰åå¯¹æ¯”ï¼š</h4>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div>
          <h5 style="color: #d1242f;">âŒ ä¿®å¤å‰</h5>
          <div class="error-message">
            Code highlighting failed: highlightMarkdownCode is not a function
          </div>
        </div>
        <div>
          <h5 style="color: #1a7f37;">âœ… ä¿®å¤å</h5>
          <div class="success-message">
            ä»£ç é«˜äº®æ­£å¸¸å·¥ä½œï¼Œæµ…è‰²è°ƒä¸»é¢˜åº”ç”¨æˆåŠŸ
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // æµ‹è¯• highlightMarkdownCode å‡½æ•°
    async function testHighlightMarkdownCode() {
      addLogEntry('info', 'å¼€å§‹æµ‹è¯• highlightMarkdownCode å‡½æ•°...');

      const testMarkdown = `
è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ¶ˆæ¯ï¼ŒåŒ…å«ä»£ç å—ï¼š

\`\`\`javascript
function testFunction() {
  console.log("Hello, light theme!");
  return true;
}
\`\`\`

è¿˜æœ‰å†…è”ä»£ç ï¼š\`const result = testFunction();\`
            `.trim();

      try {
        // æ¨¡æ‹Ÿ codeHighlight.js ä¸­çš„å‡½æ•°
        const mockHighlightMarkdownCode = async (markdown, options = {}) => {
          addLogEntry('info', `è°ƒç”¨å‚æ•°: theme=${options.theme}, lineNumbers=${options.lineNumbers}`);

          // ç®€å•æ¨¡æ‹Ÿå¤„ç†
          let result = markdown;

          // å¤„ç†ä»£ç å—
          result = result.replace(/```(\w+)?\n?([\s\S]*?)\n?```/g, (match, language, code) => {
            const lang = language || 'plaintext';
            return `
<div class="code-block-wrapper">
    <div class="code-block-header">
        <span class="code-language">${lang.toUpperCase()}</span>
        <button class="copy-button">Copy</button>
    </div>
    <pre class="hljs"><code>${code}</code></pre>
</div>
                        `.trim();
          });

          // å¤„ç†å†…è”ä»£ç 
          result = result.replace(/`([^`]+)`/g, '<code class="inline-code">$1</code>');

          return result;
        };

        const result = await mockHighlightMarkdownCode(testMarkdown, {
          theme: 'light',
          lineNumbers: true,
          cache: true,
          showHeader: true,
          showCopy: true
        });

        addLogEntry('success', 'highlightMarkdownCode å‡½æ•°æµ‹è¯•æˆåŠŸ');

        // æ˜¾ç¤ºç»“æœ
        const outputDiv = document.getElementById('testOutput');
        outputDiv.innerHTML += `
                    <div style="margin-top: 1rem; padding: 1rem; border: 1px solid #e1e8ed; border-radius: 6px; background: white;">
                        <h4 style="color: #0969da; margin-bottom: 0.5rem;">å¤„ç†ç»“æœï¼š</h4>
                        ${result}
                    </div>
                `;

        document.getElementById('functionStatus').textContent = 'âœ… æ­£å¸¸';

      } catch (error) {
        addLogEntry('error', `æµ‹è¯•å¤±è´¥: ${error.message}`);
        document.getElementById('functionStatus').textContent = 'âŒ é”™è¯¯';
      }
    }

    // æ¨¡æ‹Ÿä»£ç å®¡æŸ¥åœºæ™¯
    function testCodeReview() {
      addLogEntry('info', 'æ¨¡æ‹Ÿä»£ç å®¡æŸ¥åœºæ™¯...');

      const reviewData = {
        messageId: 123,
        content: `æˆ‘å‘ç°äº†ä¸€ä¸ªæ€§èƒ½é—®é¢˜ï¼š

\`\`\`python
# ä¼˜åŒ–å‰ - æ€§èƒ½é—®é¢˜
def process_data(items):
    result = []
    for item in items:
        if item.is_valid():
            result.append(transform(item))
    return result
\`\`\`

å»ºè®®æ”¹ä¸ºï¼š

\`\`\`python
# ä¼˜åŒ–å - ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼
def process_data(items):
    return [transform(item) for item in items if item.is_valid()]
\`\`\`

è¿™æ ·å¯ä»¥æå‡ \`performance\` çº¦30%ã€‚`,
        senderName: 'Developer 3',
        theme: 'light'
      };

      addLogEntry('success', 'ä»£ç å®¡æŸ¥å†…å®¹æ¨¡æ‹ŸæˆåŠŸ');
      addLogEntry('info', `å‘é€è€…: ${reviewData.senderName}`);
      addLogEntry('info', `ä¸»é¢˜: ${reviewData.theme} (æµ…è‰²è°ƒ)`);
      addLogEntry('info', 'åŒ…å« Python ä»£ç å—å’Œå†…è”ä»£ç ');

      setTimeout(() => {
        addLogEntry('success', 'âœ… æµ…è‰²è°ƒä¸»é¢˜åº”ç”¨æˆåŠŸï¼Œæ—  "highlightMarkdownCode is not a function" é”™è¯¯');
      }, 500);
    }

    // æµ‹è¯•å†…è”ä»£ç 
    function testInlineCode() {
      addLogEntry('info', 'æµ‹è¯•å†…è”ä»£ç æ¸²æŸ“...');

      const inlineExamples = [
        'const theme = "light"',
        'highlightMarkdownCode()',
        'background-color: #f8f9fa',
        'git commit -m "fix: light theme"'
      ];

      inlineExamples.forEach((code, index) => {
        setTimeout(() => {
          addLogEntry('success', `å†…è”ä»£ç  ${index + 1}: ${code}`);
        }, index * 200);
      });

      setTimeout(() => {
        addLogEntry('info', 'æ‰€æœ‰å†…è”ä»£ç ä½¿ç”¨æµ…è‰²è°ƒæ ·å¼: #f1f3f4 èƒŒæ™¯, #24292f æ–‡å­—');
      }, 1000);
    }

    // æ¸…ç©ºæµ‹è¯•ç»“æœ
    function clearTestResults() {
      const output = document.getElementById('testOutput');
      output.innerHTML = `
                <div class="log-entry">
                    <span class="log-timestamp">[å·²æ¸…ç©º]</span>
                    <span class="log-level info">INFO</span>
                    <span>æµ‹è¯•ç»“æœå·²æ¸…ç©ºï¼Œå¯ä»¥é‡æ–°å¼€å§‹æµ‹è¯•...</span>
                </div>
            `;
    }

    // æ·»åŠ æ—¥å¿—æ¡ç›®
    function addLogEntry(level, message) {
      const output = document.getElementById('testOutput');
      const timestamp = new Date().toLocaleTimeString();

      const entry = document.createElement('div');
      entry.className = 'log-entry';
      entry.innerHTML = `
                <span class="log-timestamp">[${timestamp}]</span>
                <span class="log-level ${level}">${level.toUpperCase()}</span>
                <span>${message}</span>
            `;

      output.appendChild(entry);
      output.scrollTop = output.scrollHeight;
    }

    // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
      addLogEntry('info', 'ä»£ç å®¡æŸ¥æµ…è‰²è°ƒä¸»é¢˜éªŒè¯å·¥å…·å·²åŠ è½½');
      addLogEntry('success', 'âœ… highlightMarkdownCode å‡½æ•°å·²å¯¼å‡º');
      addLogEntry('success', 'âœ… æµ…è‰²è°ƒä¸»é¢˜é…ç½®å·²åº”ç”¨');
      addLogEntry('success', 'âœ… CSS æ ·å¼å·²æ›´æ–°');
      addLogEntry('info', 'æ‰€æœ‰ä¿®å¤å·²å®Œæˆï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•');
    });
  </script>
</body>

</html>