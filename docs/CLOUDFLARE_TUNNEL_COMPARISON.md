# Cloudflare Tunnel å¯¹æ¯”è¯´æ˜

## ğŸ” ä¸ºä»€ä¹ˆæ—§çš„ URL ä¸èƒ½ç”¨äº†ï¼Ÿ

### Quick Tunnel (ä¸´æ—¶æ¨¡å¼) - ä½ å½“å‰ä½¿ç”¨çš„

```bash
# å¯åŠ¨å‘½ä»¤
cloudflared tunnel --url http://172.17.0.1:8080
```

**å·¥ä½œåŸç†ï¼š**
```
è¿›ç¨‹å¯åŠ¨ â†’ éšæœº URL (hook-nav-attempt-size.trycloudflare.com)
         â†“
    è¿›ç¨‹è¿è¡Œä¸­ â†’ URL æœ‰æ•ˆ âœ…
         â†“
     è¿›ç¨‹åœæ­¢ â†’ URL æ°¸ä¹…å¤±æ•ˆ âŒ
         â†“
    å†æ¬¡å¯åŠ¨ â†’ æ–°çš„éšæœº URL (personals-delays-fonts-buses.trycloudflare.com)
```

**æ—§ URL å¤±æ•ˆåŸå› ï¼š**
- cloudflared è¿›ç¨‹åœæ­¢äº†ï¼ˆæ‰‹åŠ¨æ€æ‰/ç³»ç»Ÿé‡å¯/ç½‘ç»œæ–­å¼€/èµ„æºä¸è¶³ï¼‰
- ä¸´æ—¶ URL æœ‰éšè—çš„æ—¶é—´é™åˆ¶ï¼ˆé€šå¸¸ 12-24 å°æ—¶ï¼‰
- Quick Tunnel è®¾è®¡å°±æ˜¯ä¸´æ—¶ä½¿ç”¨ï¼Œä¸æ˜¯ç”Ÿäº§ç¯å¢ƒæ–¹æ¡ˆ

---

## âœ… è§£å†³æ–¹æ¡ˆï¼šNamed Tunnelï¼ˆå›ºå®šåŸŸåï¼‰

### Named Tunnel (æŒä¹…åŒ–æ¨¡å¼) - **100% å…è´¹**

```bash
# ä¸€æ¬¡æ€§è®¾ç½®
cloudflared tunnel login
cloudflared tunnel create fechatter-prod
cloudflared tunnel run fechatter-prod
```

**å·¥ä½œåŸç†ï¼š**
```
ä¸€æ¬¡é…ç½® â†’ å›ºå®š URL (fechatter-prod.cfargotunnel.com)
         â†“
    æ°¸ä¹…æœ‰æ•ˆ â†’ URL æ°¸ä¸æ”¹å˜ âœ…
         â†“
    è¿›ç¨‹é‡å¯ â†’ åŒæ ·çš„ URL âœ…
         â†“
    ç³»ç»Ÿé‡å¯ â†’ åŒæ ·çš„ URL âœ…
```

---

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”

| ç‰¹æ€§ | Quick Tunnel (å½“å‰) | Named Tunnel (æ¨è) |
|------|-------------------|-------------------|
| **ä»·æ ¼** | å…è´¹ | **å…è´¹** |
| **URL ç¨³å®šæ€§** | âŒ æ¯æ¬¡é‡å¯æ”¹å˜ | âœ… **æ°¸ä¹…å›ºå®š** |
| **éœ€è¦è´¦å·** | âŒ ä¸éœ€è¦ | âœ… éœ€è¦ï¼ˆå…è´¹æ³¨å†Œï¼‰ |
| **é…ç½®å¤æ‚åº¦** | ç®€å•ï¼ˆé›¶é…ç½®ï¼‰ | ä¸­ç­‰ï¼ˆä¸€æ¬¡æ€§é…ç½®ï¼‰ |
| **ç”Ÿäº§ç¯å¢ƒ** | âŒ ä¸æ¨è | âœ… **æ¨è** |
| **è‡ªåŠ¨é‡è¿** | âŒ å¦ | âœ… æ˜¯ |
| **è‡ªå®šä¹‰åŸŸå** | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ |
| **ä»£ç éœ€è¦æ›´æ–°** | âœ… æ¯æ¬¡é‡å¯éƒ½è¦æ›´æ–° | âœ… **åªéœ€æ›´æ–°ä¸€æ¬¡** |
| **Vercel éƒ¨ç½²** | âš ï¸ æ¯æ¬¡éœ€è¦é‡æ–°éƒ¨ç½² | âœ… **æ— éœ€é‡æ–°éƒ¨ç½²** |

---

## ğŸš€ ç«‹å³å‡çº§åˆ° Named Tunnel

### æ–¹å¼ 1: ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd /Users/zhangkaiqi/Rust/fechatter_frontend
bash scripts/setup-cloudflare-named-tunnel.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. æŒ‡å¯¼ä½ ç™»å½• Cloudflare è´¦å·
2. åˆ›å»ºå›ºå®šåç§°çš„ Tunnel
3. é…ç½® DNSï¼ˆä½¿ç”¨ `.cfargotunnel.com` å­åŸŸåï¼‰
4. æ›´æ–°æ‰€æœ‰é…ç½®æ–‡ä»¶
5. æµ‹è¯•è¿é€šæ€§

**æ—¶é—´ï¼š5 åˆ†é’Ÿ**

---

### æ–¹å¼ 2: æ‰‹åŠ¨è®¾ç½®

```bash
# 1. SSH åˆ°æœåŠ¡å™¨
ssh root@45.77.178.85

# 2. ç™»å½• Cloudflareï¼ˆä¼šæ‰“å¼€æµè§ˆå™¨ï¼‰
cloudflared tunnel login

# 3. åˆ›å»º Named Tunnel
cloudflared tunnel create fechatter-prod

# 4. è®°å½• Tunnel ID
cloudflared tunnel list

# 5. åˆ›å»ºé…ç½®æ–‡ä»¶
mkdir -p ~/.cloudflared
cat > ~/.cloudflared/config.yml << 'EOF'
tunnel: <YOUR_TUNNEL_ID>
credentials-file: /root/.cloudflared/<YOUR_TUNNEL_ID>.json

ingress:
  - hostname: "*"
    service: http://172.17.0.1:8080
  - service: http_status:404
EOF

# 6. å¯åŠ¨ Named Tunnel
cloudflared tunnel run fechatter-prod
```

---

## ğŸ¯ å‡çº§åçš„å¥½å¤„

### ç«‹å³è·å¾—ï¼š
- âœ… **å›ºå®š URL**ï¼š`fechatter-prod.cfargotunnel.com`ï¼ˆæˆ–è‡ªå®šä¹‰åŸŸåï¼‰
- âœ… **æ°¸ä¸æ”¹å˜**ï¼šé‡å¯ã€æ–­ç½‘ã€ç³»ç»Ÿæ›´æ–°éƒ½ä¸å½±å“
- âœ… **è‡ªåŠ¨é‡è¿**ï¼šç½‘ç»œé—®é¢˜è‡ªåŠ¨æ¢å¤
- âœ… **ç”Ÿäº§çº§åˆ«**ï¼šCloudflare å®˜æ–¹æ¨èçš„ç”Ÿäº§æ–¹æ¡ˆ

### å¼€å‘ä½“éªŒæ”¹å–„ï¼š
- âœ… **æ— éœ€é¢‘ç¹æ›´æ–°é…ç½®**ï¼šURL å›ºå®šååªéœ€é…ç½®ä¸€æ¬¡
- âœ… **æ— éœ€é‡æ–°éƒ¨ç½² Vercel**ï¼šå‰ç«¯ä»£ç ä¸éœ€è¦æ”¹åŠ¨
- âœ… **å›¢é˜Ÿåä½œå‹å¥½**ï¼šURL å›ºå®šï¼Œå›¢é˜Ÿæˆå‘˜å¯ä»¥ä¿å­˜
- âœ… **æ–‡æ¡£æ°¸ä¹…æœ‰æ•ˆ**ï¼šAPI æ–‡æ¡£ä¸­çš„ URL ä¸ä¼šå¤±æ•ˆ

---

## ğŸ’¡ å¸¸è§é—®é¢˜

### Q: Named Tunnel çœŸçš„å…è´¹å—ï¼Ÿ
**A:** æ˜¯çš„ï¼Œ100% å…è´¹ã€‚Cloudflare Tunnel æ— è®º Quick è¿˜æ˜¯ Named æ¨¡å¼éƒ½å®Œå…¨å…è´¹ã€‚

### Q: éœ€è¦ä¿¡ç”¨å¡å—ï¼Ÿ
**A:** ä¸éœ€è¦ã€‚åªéœ€è¦ä¸€ä¸ªå…è´¹çš„ Cloudflare è´¦å·ï¼ˆé‚®ç®±æ³¨å†Œå³å¯ï¼‰ã€‚

### Q: å¦‚æœæ²¡æœ‰è‡ªå·±çš„åŸŸåæ€ä¹ˆåŠï¼Ÿ
**A:** ä½¿ç”¨ Cloudflare æä¾›çš„å…è´¹å­åŸŸåï¼š`fechatter-prod.cfargotunnel.com`

### Q: ç°æœ‰çš„ä¸´æ—¶ Tunnel éœ€è¦åœæ­¢å—ï¼Ÿ
**A:** æ˜¯çš„ï¼Œè®¾ç½®è„šæœ¬ä¼šè‡ªåŠ¨åœæ­¢æ—§çš„ Quick Tunnel å¹¶å¯åŠ¨æ–°çš„ Named Tunnelã€‚

### Q: é…ç½®æ–‡ä»¶ä¼šè‡ªåŠ¨æ›´æ–°å—ï¼Ÿ
**A:** æ˜¯çš„ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨æ›´æ–°æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼ˆconfig/*.ymlã€vite.config.jsã€apiUrlResolver.jsï¼‰ã€‚

### Q: Vercel éƒ¨ç½²çš„å‰ç«¯éœ€è¦é‡æ–°éƒ¨ç½²å—ï¼Ÿ
**A:** ä¸éœ€è¦ã€‚å› ä¸º Vercel ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼Œå‰ç«¯ä»£ç ä¸ä¾èµ–ç¡¬ç¼–ç çš„ URLã€‚

---

## ğŸ“‹ å‡çº§æ£€æŸ¥æ¸…å•

- [ ] è¿è¡Œè®¾ç½®è„šæœ¬æˆ–æ‰‹åŠ¨é…ç½®
- [ ] éªŒè¯æ–° URL å¯ä»¥è®¿é—®
- [ ] æµ‹è¯• API ç™»å½•åŠŸèƒ½
- [ ] æ›´æ–°æœ¬åœ°å¼€å‘é…ç½®
- [ ] æµ‹è¯• SSE è¿æ¥
- [ ] ï¼ˆå¯é€‰ï¼‰æ·»åŠ è‡ªå®šä¹‰åŸŸå
- [ ] ï¼ˆå¯é€‰ï¼‰é…ç½®ç³»ç»ŸæœåŠ¡è‡ªåŠ¨å¯åŠ¨

---

## ğŸ”— å‚è€ƒèµ„æ–™

- [Cloudflare Tunnel å®˜æ–¹æ–‡æ¡£](https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/)
- [Named Tunnel é…ç½®æŒ‡å—](https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/tunnel-guide/)
- [è‡ªå®šä¹‰åŸŸåè®¾ç½®](https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/routing-to-tunnel/)

---

**æ€»ç»“ï¼šæ—§çš„ Quick Tunnel å¤±æ•ˆæ˜¯æ­£å¸¸çš„ï¼Œè¿™å°±æ˜¯ä¸´æ—¶æ¨¡å¼çš„è®¾è®¡ã€‚å‡çº§åˆ° Named Tunnel å¯ä»¥ä¸€åŠ³æ°¸é€¸åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚**

