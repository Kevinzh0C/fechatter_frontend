/* ğŸ‡¯ğŸ‡µ Japanese Font Fix - æ—¥è¯­å­—ä½“æ˜¾ç¤ºä¿®å¤
 * è§£å†³æ—¥è¯­æ–‡å­—æ˜¾ç¤ºå¼‚å¸¸ã€å­—ç¬¦é—´è·å’Œæ¸²æŸ“é—®é¢˜
 * ç¡®ä¿æ—¥è¯­åœ¨æ‰€æœ‰ç»„ä»¶ä¸­æ­£ç¡®æ˜¾ç¤º
 */

:root {
  /* ğŸŒ æ—¥è¯­ä¼˜åŒ–å­—ä½“æ ˆ */
  --font-family-japanese: 
    'Hiragino Kaku Gothic ProN', 
    'Hiragino Sans', 
    'Yu Gothic Medium', 
    'Yu Gothic', 
    'Meiryo', 
    'Noto Sans CJK JP', 
    'Source Han Sans JP', 
    'MS PGothic',
    -apple-system, 
    BlinkMacSystemFont, 
    sans-serif;

  /* ğŸ“ æ—¥è¯­ä¸“ç”¨æ’ç‰ˆå‚æ•° */
  --japanese-letter-spacing: 0.02em;
  --japanese-line-height: 1.6;
  --japanese-font-weight-normal: 400;
  --japanese-font-weight-medium: 500;
  --japanese-font-weight-bold: 600;
  
  /* ğŸ¨ æ—¥è¯­æ–‡æœ¬æ¸²æŸ“ä¼˜åŒ– */
  --japanese-font-smooth: antialiased;
  --japanese-text-rendering: optimizeLegibility;
}

/* ğŸ¯ å…¨å±€æ—¥è¯­å­—ä½“åº”ç”¨ */
html[lang="ja"], 
html[lang^="ja-"],
body[lang="ja"], 
body[lang^="ja-"] {
  font-family: var(--font-family-japanese) !important;
  letter-spacing: var(--japanese-letter-spacing);
  line-height: var(--japanese-line-height);
  -webkit-font-smoothing: var(--japanese-font-smooth);
  -moz-osx-font-smoothing: grayscale;
  text-rendering: var(--japanese-text-rendering);
}

/* ğŸ”¤ æ—¥è¯­å†…å®¹ä¼˜åŒ–é€‰æ‹©å™¨ */
:lang(ja),
[lang="ja"],
[lang^="ja-"],
.japanese-text,
.content-japanese {
  font-family: var(--font-family-japanese) !important;
  letter-spacing: var(--japanese-letter-spacing) !important;
  line-height: var(--japanese-line-height) !important;
  -webkit-font-smoothing: var(--japanese-font-smooth);
  -moz-osx-font-smoothing: grayscale;
  text-rendering: var(--japanese-text-rendering);
}

/* ğŸ“ æ¶ˆæ¯ç»„ä»¶ä¸­çš„æ—¥è¯­ä¼˜åŒ– */
.discord-message-item :lang(ja),
.discord-message-item [lang="ja"],
.discord-message-item [lang^="ja-"],
.message-content :lang(ja),
.message-content [lang="ja"],
.message-content [lang^="ja-"] {
  font-family: var(--font-family-japanese) !important;
  letter-spacing: var(--japanese-letter-spacing) !important;
  line-height: var(--japanese-line-height) !important;
  font-weight: var(--japanese-font-weight-normal) !important;
}

/* ğŸ“± èŠå¤©è¾“å…¥æ¡†æ—¥è¯­ä¼˜åŒ– */
.message-input :lang(ja),
.message-input [lang="ja"],
.message-input [lang^="ja-"],
textarea:lang(ja),
input:lang(ja) {
  font-family: var(--font-family-japanese) !important;
  letter-spacing: var(--japanese-letter-spacing) !important;
  line-height: var(--japanese-line-height) !important;
}

/* ğŸ‘¤ ç”¨æˆ·åæ—¥è¯­æ˜¾ç¤ºä¼˜åŒ– */
.username-button :lang(ja),
.username-button [lang="ja"],
.sender-name :lang(ja),
.sender-name [lang="ja"],
.user-name :lang(ja),
.user-name [lang="ja"] {
  font-family: var(--font-family-japanese) !important;
  letter-spacing: var(--japanese-letter-spacing) !important;
  font-weight: var(--japanese-font-weight-medium) !important;
}

/* ğŸ·ï¸ é¢‘é“åç§°æ—¥è¯­ä¼˜åŒ– */
.channel-title :lang(ja),
.channel-title [lang="ja"],
.chat-title :lang(ja),
.chat-title [lang="ja"] {
  font-family: var(--font-family-japanese) !important;
  letter-spacing: var(--japanese-letter-spacing) !important;
  font-weight: var(--japanese-font-weight-medium) !important;
}

/* ğŸ¨ è‡ªåŠ¨æ£€æµ‹æ—¥è¯­å†…å®¹ */
/* æ£€æµ‹åŒ…å«æ—¥è¯­å­—ç¬¦çš„å…ƒç´ å¹¶åº”ç”¨ä¼˜åŒ– */
*:not(script):not(style):not(code):not(pre) {
  /* ä½¿ç”¨CSSå±æ€§é€‰æ‹©å™¨æ£€æµ‹æ—¥è¯­å†…å®¹ */
}

/* ğŸ’¡ æ—¥è¯­ç‰¹æ®Šå­—ç¬¦ä¼˜åŒ– */
/* å¹³å‡åã€ç‰‡å‡åã€æ±‰å­—èŒƒå›´ */
*[data-content*="ã‚"], *[data-content*="ã‚¢"], *[data-content*="ä¸€"],
*:has-text(/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/) {
  font-family: var(--font-family-japanese) !important;
  letter-spacing: var(--japanese-letter-spacing) !important;
  line-height: var(--japanese-line-height) !important;
}

/* ğŸ”§ å¼ºåˆ¶æ—¥è¯­å­—ä½“ä¿®å¤ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰ */
.japanese-font-fix,
.force-japanese-font {
  font-family: var(--font-family-japanese) !important;
  letter-spacing: var(--japanese-letter-spacing) !important;
  line-height: var(--japanese-line-height) !important;
  -webkit-font-smoothing: var(--japanese-font-smooth) !important;
  -moz-osx-font-smoothing: grayscale !important;
  text-rendering: var(--japanese-text-rendering) !important;
  word-break: keep-all !important;
  overflow-wrap: break-word !important;
}

/* ğŸ“ æ—¥è¯­æ–‡æœ¬å¸ƒå±€ä¿®å¤ */
.japanese-text-layout {
  /* é˜²æ­¢æ—¥è¯­æ–‡å­—è¢«å‹ç¼© */
  min-height: 1.6em;
  white-space: normal;
  word-spacing: normal;
  letter-spacing: var(--japanese-letter-spacing) !important;
  
  /* ç¡®ä¿æ—¥è¯­æ–‡å­—ä¸ä¼šé‡å  */
  line-height: var(--japanese-line-height) !important;
  
  /* æ—¥è¯­æ ‡ç‚¹ç¬¦å·ä¼˜åŒ– */
  hanging-punctuation: allow-end;
  text-align: left;
}

/* ğŸ¯ å“åº”å¼æ—¥è¯­å­—ä½“å¤§å° */
@media (max-width: 768px) {
  :lang(ja),
  [lang="ja"],
  [lang^="ja-"],
  .japanese-text {
    /* ç§»åŠ¨ç«¯ç¨å¾®å¢å¤§å­—ä½“ä»¥æé«˜å¯è¯»æ€§ */
    font-size: 1.05em;
    letter-spacing: 0.03em;
    line-height: 1.65;
  }
}

/* ğŸŒ™ æš—è‰²ä¸»é¢˜æ—¥è¯­ä¼˜åŒ– */
@media (prefers-color-scheme: dark) {
  :lang(ja),
  [lang="ja"],
  [lang^="ja-"],
  .japanese-text {
    /* æš—è‰²ä¸»é¢˜ä¸‹å¢å¼ºå­—ä½“æ¸²æŸ“ */
    -webkit-font-smoothing: subpixel-antialiased;
    font-weight: 450; /* ç¨å¾®å¢åŠ å­—é‡ä»¥æé«˜å¯è¯»æ€§ */
  }
}

/* ğŸ–¨ï¸ é«˜åˆ†è¾¨ç‡å±å¹•ä¼˜åŒ– */
@media (min-resolution: 2dppx) {
  :lang(ja),
  [lang="ja"],
  [lang^="ja-"],
  .japanese-text {
    -webkit-font-smoothing: subpixel-antialiased;
    -moz-osx-font-smoothing: auto;
  }
}

/* ğŸŒ ç‰¹æ®Šæ—¥è¯­å…ƒç´ ä¿®å¤ */
/* æ—¥è¯­å¼•å·å’Œæ ‡ç‚¹ç¬¦å· */
.japanese-punctuation {
  font-feature-settings: "palt" 1, "halt" 1; /* æ¯”ä¾‹å’Œå…¨è§’æ ‡ç‚¹ */
  text-spacing: ideograph-alpha ideograph-numeric;
}

/* ğŸ” æ—¥è¯­æœç´¢ç»“æœé«˜äº® */
mark:lang(ja),
.search-highlight:lang(ja) {
  font-family: var(--font-family-japanese) !important;
  letter-spacing: var(--japanese-letter-spacing) !important;
  background-color: rgba(255, 235, 59, 0.3);
  padding: 0.1em 0.2em;
  border-radius: 2px;
}

/* ğŸ“ æ—¥è¯­ä»£ç å’Œé¢„æ ¼å¼åŒ–æ–‡æœ¬ */
code:lang(ja),
pre:lang(ja),
.hljs:lang(ja) {
  font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', 'Source Code Pro', 'Menlo', 'Consolas', monospace !important;
  /* ä»£ç ä¸­çš„æ—¥è¯­æ³¨é‡Šä»ä½¿ç”¨ç­‰å®½å­—ä½“ */
} 