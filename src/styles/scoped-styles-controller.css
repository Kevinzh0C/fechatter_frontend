/* ğŸ¯ Scoped Styles Controller - CSSä½œç”¨åŸŸæ§åˆ¶å™¨
 * ç¡®ä¿æ¯ä¸ªCSSæ–‡ä»¶åªåœ¨å…¶è´Ÿè´£çš„é¡µé¢/ç»„ä»¶èŒƒå›´å†…ç”Ÿæ•ˆ
 * é˜²æ­¢å…¨å±€æ ·å¼æ±¡æŸ“å’Œå†²çª
 * ğŸš¨ CRITICAL: ä¸è¦ç ´ååŸºç¡€åŠŸèƒ½ç»„ä»¶
 */

/* ===== ğŸ” ç™»å½•é¡µé¢æ ·å¼é™å®š ===== */
/* ä»…åœ¨ç™»å½•é¡µé¢å¯ç”¨ç™»å½•ç›¸å…³æ ·å¼ */
body:not([data-route="/login"]):not(.login-page):not([data-page="login"]) {
  /* ç¦ç”¨ç™»å½•é¡µé¢ç‰¹å®šçš„å…¨å±€æ ·å¼è¦†ç›– */
  --login-protection-disabled: true;
}

/* ===== ğŸš¨ CRITICAL: ä¿æŠ¤åŸºç¡€åŠŸèƒ½ç»„ä»¶ ===== */
/* ç¡®ä¿ä»¥ä¸‹ç»„ä»¶åœ¨æ‰€æœ‰é¡µé¢éƒ½èƒ½æ­£å¸¸å·¥ä½œ */

/* ä¿æŠ¤æ¶ˆæ¯è¾“å…¥æ¡† - åœ¨æ‰€æœ‰é¡µé¢éƒ½å¿…é¡»æ­£å¸¸å·¥ä½œ */
.message-input,
.message-textarea,
.input-container,
.main-input-area,
.input-btn {
  /* é˜²æ­¢è¢«é‡ç½® - è¿™äº›æ˜¯æ ¸å¿ƒåŠŸèƒ½ */
  all: revert-layer !important;
}

/* ä¿æŠ¤æ»šåŠ¨æ¡ */
*::-webkit-scrollbar,
*::-webkit-scrollbar-track,
*::-webkit-scrollbar-thumb {
  /* é˜²æ­¢æ»šåŠ¨æ¡è¢«ç ´å */
  all: revert-layer !important;
}

/* ä¿æŠ¤åŸºç¡€å¸ƒå±€å…ƒç´  */
.messages-container,
.input-container,
.chat-layout,
.chat-content {
  /* é˜²æ­¢èŠå¤©å¸ƒå±€è¢«ç ´å */
  all: revert-layer !important;
}

/* ===== ğŸ’¬ èŠå¤©é¡µé¢æ ·å¼é™å®š - ä¿®å¤ç‰ˆ ===== */
/* ä»…åœ¨èŠå¤©é¡µé¢å¯ç”¨èŠå¤©ç›¸å…³å¢å¼ºæ ·å¼ï¼Œä½†ä¸ç ´ååŸºç¡€åŠŸèƒ½ */
body:not([data-route*="/chat"]):not(.chat-page) .discord-message:not(.message-input *):not(.input-container *),
body:not([data-route*="/chat"]):not(.chat-page) .simple-message-list:not(.message-input *) {
  /* é‡ç½®Discordæ¶ˆæ¯å¢å¼ºæ ·å¼ï¼Œä½†ä¿æŠ¤è¾“å…¥æ¡† */
  padding: revert;
  margin: revert;
  background: revert;
  transition: revert;
}

/* ===== ğŸ·ï¸ é¢‘é“åˆ—è¡¨æ ·å¼é™å®š - ä¿®å¤ç‰ˆ ===== */
/* ä»…åœ¨ä¸»é¡µé¢å’ŒèŠå¤©é¡µé¢å¯ç”¨é¢‘é“åˆ—è¡¨æ ·å¼ */
body:not([data-route="/home"]):not([data-route*="/chat"]):not(.has-sidebar) .channel-item:not(.message-input *),
body:not([data-route="/home"]):not([data-route*="/chat"]):not(.has-sidebar) .dm-item:not(.message-input *),
body:not([data-route="/home"]):not([data-route*="/chat"]):not(.has-sidebar) .group-item:not(.message-input *) {
  /* é‡ç½®é¢‘é“åˆ—è¡¨æ ·å¼ï¼Œä½†ä¿æŠ¤è¾“å…¥æ¡†åŒºåŸŸ */
  display: revert !important;
  padding: revert !important;
  margin: revert !important;
}

/* ===== ğŸ“ ä»£ç é«˜äº®æ ·å¼é™å®š - ä¿®å¤ç‰ˆ ===== */
/* ä»…åœ¨éœ€è¦çš„é¡µé¢å¯ç”¨ä»£ç é«˜äº®ï¼Œä½†ä¸å½±å“è¾“å…¥æ¡† */
body:not([data-route*="/chat"]):not([data-route="/demo"]):not([data-route="/debug"]):not(.has-code-content) .enhanced-code-container:not(.message-input *),
body:not([data-route*="/chat"]):not([data-route="/demo"]):not([data-route="/debug"]):not(.has-code-content) .hljs:not(.message-input *) {
  /* é‡ç½®ä»£ç é«˜äº®æ ·å¼ï¼Œä½†ä¿æŠ¤è¾“å…¥æ¡†ä¸­çš„ä»£ç  */
  font-family: revert !important;
  font-size: revert !important;
  padding: revert !important;
  background: revert !important;
}

/* ===== ğŸŒ CJKå­—ä½“æ ·å¼é™å®š - ä¿å®ˆç‰ˆ ===== */
/* CJKå­—ä½“ä¼˜åŒ–ä»…åœ¨éœ€è¦çš„é¡µé¢å¯ç”¨ï¼Œä½†ä¸å½±å“åŸºç¡€åŠŸèƒ½ */
body:not(.has-cjk-content):not([data-route="/home"]):not([data-route*="/chat"]) .channel-item:not(.message-input *) {
  /* åªå½±å“é¢‘é“é¡¹ç›®ï¼Œä¸å½±å“è¾“å…¥æ¡† */
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
}

/* ===== ğŸ¯ é¡µé¢ç‰¹å®šæ ·å¼å¯ç”¨æ ‡è®° ===== */

/* èŠå¤©é¡µé¢ - å¯ç”¨æ‰€æœ‰åŠŸèƒ½ */
body[data-route*="/chat"],
body.chat-page {
  --enable-message-styles: true;
  --enable-code-highlight: true;
  --enable-cjk-fonts: true;
  --enable-channel-list: true;
  --enable-input-components: true;
  --enable-scroll-components: true;
}

/* ä¸»é¡µ - å¯ç”¨ä¾§è¾¹æ åŠŸèƒ½ */
body[data-route="/home"],
body.home-page {
  --enable-channel-list: true;
  --enable-cjk-fonts: true;
  --enable-input-components: true;
  --enable-scroll-components: true;
}

/* ç™»å½•é¡µé¢ - ä»…å¯ç”¨ç™»å½•æ ·å¼ */
body[data-route="/login"],
body.login-page {
  --enable-login-protection: true;
}

/* Demo/Debugé¡µé¢ - å¯ç”¨ä»£ç é«˜äº®å’ŒåŸºç¡€åŠŸèƒ½ */
body[data-route="/demo"],
body[data-route="/debug"],
body.demo-page,
body.debug-page {
  --enable-code-highlight: true;
  --enable-input-components: true;
  --enable-scroll-components: true;
}

/* ===== ğŸ›¡ï¸ æ ¸å¿ƒåŠŸèƒ½ä¿æŠ¤ ===== */

/* ğŸš¨ EMERGENCY: ç¡®ä¿è¾“å…¥æ¡†ç»„ä»¶æ°¸è¿œå¯ç”¨ */
.message-input,
.message-input *,
.input-container,
.input-container *,
.main-input-area,
.main-input-area *,
.message-textarea {
  /* ç»å¯¹é˜²æŠ¤ - è¿™äº›ç»„ä»¶å¿…é¡»åœ¨ä»»ä½•é¡µé¢éƒ½èƒ½å·¥ä½œ */
  all: revert-layer !important;
  position: relative !important;
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  pointer-events: auto !important;
}

/* ğŸš¨ EMERGENCY: ç¡®ä¿æ»šåŠ¨åŠŸèƒ½æ°¸è¿œå¯ç”¨ */
.messages-container,
.chat-content,
.discord-message-list {
  /* é˜²æ­¢æ»šåŠ¨è¢«ç ´å */
  overflow: auto !important;
  max-height: revert !important;
  height: revert !important;
}

/* ğŸš¨ EMERGENCY: ç¡®ä¿åŸºç¡€å¸ƒå±€ä¸è¢«ç ´å */
.chat-layout,
.chat-view,
.app-layout {
  /* åŸºç¡€å¸ƒå±€ä¿æŠ¤ */
  display: flex !important;
  flex-direction: column !important;
  height: 100vh !important;
  width: 100% !important;
}

/* ===== ğŸ”§ æ¡ä»¶æ ·å¼åº”ç”¨ - å®‰å…¨ç‰ˆ ===== */

/* åªæœ‰æ ‡è®°äº†ç‰¹å®šç±»çš„å…ƒç´ æ‰åº”ç”¨å¯¹åº”æ ·å¼ï¼Œä½†ä¸ç ´ååŸºç¡€åŠŸèƒ½ */
.message-content:not(.discord-enhanced):not(.message-input):not(.message-input *),
.channel-item:not(.sidebar-enhanced):not(.message-input):not(.message-input *),
.code-block:not(.highlight-enhanced):not(.message-input):not(.message-input *) {
  /* ä¿æŒåŸå§‹æ ·å¼ï¼Œä¸åº”ç”¨å¢å¼ºï¼Œä½†ä¿æŠ¤è¾“å…¥ç»„ä»¶ */
  all: revert;
}

/* ===== ğŸ“± å“åº”å¼ä½œç”¨åŸŸ ===== */

/* ç§»åŠ¨ç«¯æ ·å¼é™å®š */
@media (max-width: 768px) {
  /* ç¡®ä¿ç§»åŠ¨ç«¯åŸºç¡€åŠŸèƒ½ä¸è¢«ç ´å */
  .message-input,
  .input-container,
  .main-input-area {
    /* ç§»åŠ¨ç«¯è¾“å…¥æ¡†ä¿æŠ¤ */
    all: revert-layer !important;
  }
}

/* ===== ğŸ¨ ä¸»é¢˜ä½œç”¨åŸŸ ===== */

/* æš—è‰²ä¸»é¢˜æ ·å¼ä»…åœ¨æš—è‰²æ¨¡å¼å¯ç”¨æ—¶ç”Ÿæ•ˆï¼Œä½†ä¸å½±å“åŠŸèƒ½ */
body:not([data-theme="dark"]):not(.dark-mode) {
  /* é‡ç½®æš—è‰²ä¸»é¢˜å˜é‡ï¼Œä½†ä¿æŠ¤åŠŸèƒ½ç»„ä»¶ */
  --bg-primary: revert;
  --text-primary: revert;
  --border-primary: revert;
}

/* ===== ğŸš¨ ç´§æ€¥é‡ç½®æœºåˆ¶ ===== */

/* ä¸ºç‰¹å®šé¡µé¢æä¾›å®Œå…¨é‡ç½®é€‰é¡¹ï¼Œä½†ä¿æŠ¤æ ¸å¿ƒåŠŸèƒ½ */
body.reset-all-styles *:not(.message-input):not(.message-input *):not(.input-container):not(.input-container *) {
  all: revert !important;
}

body.minimal-styles *:not(.message-input):not(.message-input *):not(.input-container):not(.input-container *) {
  /* åªä¿ç•™æœ€åŸºæœ¬çš„æ ·å¼ï¼Œä½†ä¿æŠ¤è¾“å…¥åŠŸèƒ½ */
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: inherit;
  color: inherit;
  background: transparent;
  border: none;
}

/* ===== ğŸ” è°ƒè¯•è¾…åŠ© ===== */

/* å¼€å‘æ¨¡å¼ä¸‹æ˜¾ç¤ºå½“å‰é¡µé¢çš„æ ·å¼ä½œç”¨åŸŸ */
body[data-debug="true"]::before {
  content: "Route: " attr(data-route) " | Page: " attr(class);
  position: fixed;
  top: 0;
  right: 0;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 8px;
  font-size: 12px;
  z-index: 9999;
  border-radius: 0 0 0 8px;
} 